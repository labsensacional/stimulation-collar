es1 = [1333, -822, 199, -814, 193, -796, 711, -310, 723, -286, 697, -296, 739, -258, 215, -826, 193, -796, 225, -792, 195, -822, 707, -312, 691, -320, 711, -262, 739, -258, 737, -292, 731, -276, 215, -798, 213, -782, 231, -806, 193, -796, 225, -792, 195, -820, 195, -792, 743, -278, 215, -784, 245, -772, 229, -770, 227, -794, 223, -794, 203, -800, 205, -794, 713, -292, 221, -806, 715, -310, 689, -282, 739, -276, 719, -290, 713, -292, 213, -794, 747, -276, 215, -796, 211, -782, 229, -1172, 1341, -786, 245, -774, 227, -804, 715, -274, 725, -284, 729, -298, 709, -290, 183, -832, 193, -796, 225, -792, 195, -820, 709, -314, 691, -320, 677, -296, 737, -258, 737, -294, 727, -288, 211, -790, 225, -792, 193, -790, 227, -790, 227, -792, 225, -792, 193, -792, 737, -284, 217, -794, 201, -816, 193, -798, 225, -792, 195, -822, 195, -790, 225, -792, 741, -280, 215, -786, 711, -290, 715, -292, 731, -310, 689, -318, 699, -312, 213, -772, 723, -310, 215, -764, 211, -786, 231, -1172]

es2 = [1343, -784, 243, -770, 229, -770, 747, -276, 723, -284, 705, -304, 717, -290, 219, -800, 193, -796, 225, -796, 201, -802, 719, -320, 679, -294, 735, -286, 705, -286, 733, -310, 689, -282, 217, -794, 235, -780, 211, -820, 199, -780, 227, -794, 225, -792, 193, -826, 707, -282, 215, -794, 225, -796, 201, -798, 211, -784, 229, -808, 193, -798, 225, -792, 709, -312, 215, -762, 745, -290, 689, -292, 735, -308, 689, -282, 727, -316, 215, -792, 707, -290, 215, -800, 193, -800, 237, -1156, 1359, -776, 235, -788, 195, -802, 711, -310, 723, -286, 707, -302, 715, -290, 217, -798, 193, -796, 225, -794, 195, -822, 709, -312, 693, -318, 679, -296, 735, -288, 703, -288, 729, -288, 213, -794, 235, -792, 193, -798, 203, -794, 245, -772, 229, -802, 193, -798, 713, -312, 215, -782, 211, -782, 231, -774, 227, -796, 201, -796, 225, -794, 223, -798, 715, -284, 215, -786, 727, -310, 689, -316, 699, -312, 689, -290, 717, -292, 213, -794, 745, -276, 215, -776, 217, -798, 247, -1018]

es3 = [1375, -778, 225, -798, 201, -798, 735, -276, 731, -284, 707, -304, 715, -288, 219, -800, 193, -800, 237, -794, 201, -796, 713, -292, 731, -258, 737, -310, 689, -318, 701, -312, 685, -290, 221, -804, 195, -798, 225, -792, 193, -822, 195, -788, 227, -792, 225, -792, 705, -316, 215, -792, 205, -796, 195, -800, 237, -790, 193, -792, 225, -794, 703, -318, 217, -760, 231, -812, 715, -276, 723, -284, 737, -274, 717, -290, 711, -292, 731, -312, 215, -770, 217, -798, 185, -832, 183, -1064, 1345, -786, 243, -768, 227, -804, 715, -276, 725, -284, 731, -264, 741, -258, 215, -828, 193, -796, 225, -792, 195, -822, 707, -312, 691, -320, 709, -264, 739, -260, 735, -292, 733, -276, 215, -798, 211, -784, 231, -772, 225, -794, 225, -792, 193, -822, 193, -790, 741, -278, 215, -794, 243, -770, 195, -800, 227, -792, 225, -792, 195, -790, 745, -278, 215, -816, 211, -772, 723, -310, 689, -316, 701, -312, 685, -290, 717, -294, 731, -312, 215, -770, 217, -800, 185, -796, 217, -1162]


def convert_to_binary(es, threshold_short=350, threshold_long=600):
    """
    Converts raw OOK signal durations into a binary string.
    
    Parameters:
    - es: List of pulse durations (positive = high, negative = low).
    - threshold_short: Max duration considered a 'short' pulse.
    - threshold_long: Min duration considered a 'long' pulse.
    
    Returns:
    - A binary string.
    """
    binary = ""
    i = 0
    while i < len(es) - 1:
        high = es[i]
        low = -es[i + 1]

        # Check if the pulse durations match a short or long pattern
        if isinstance(high, int) and isinstance(low, int):
            if abs(high) < threshold_short and abs(low) >= threshold_long:
                binary += '0'
            elif abs(high) >= threshold_long and abs(low) < threshold_short:
                binary += '1'
            else:
                # Not recognized; optional: skip or mark as '?'
                binary += '?'
        i += 2  # Advance to next pulse pair

    return binary

print("es1 binary:", convert_to_binary(es1))
print("es2 binary:", convert_to_binary(es2))
print("es3 binary:", convert_to_binary(es3))